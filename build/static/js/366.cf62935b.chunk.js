"use strict";(self.webpackChunkcliennt=self.webpackChunkcliennt||[]).push([[366],{7449:function(e,t,s){s.r(t),s.d(t,{default:function(){return Z}});var r=s(3433),n=s(4165),a=s(5861),i=s(9439),c=s(2791),l=s(5886),o=s(7083),u=s(9609),d=s(5543),f=s(8316),m=s(3153),x=s(2199),p=s(9555),h=s(2426),v=s.n(h),w=s(184),j=function(e){var t=e.message,s=(0,m.CG)((function(e){return e.user}));return(0,w.jsx)("div",{className:"w-full my-1 flex flex-row ".concat(t.senderId.id===s.user.id?"justify-end":"justify-start"),children:(0,w.jsxs)("div",{className:"relative p-1 px-2 pr-10 rounded-md bg-light max-w-[75%]",children:[(0,w.jsx)("span",{className:"text-sm font-medium text-primary",children:t.message}),(0,w.jsx)("span",{className:"absolute text-[0.65rem] text-thirdy right-1 bottom-1",children:v()(t.date).format("HH:mm")})]})})},g=function(e){var t=e.receiverUser,s=e.roomId,h=e.messages,v=e.setMessages,g=(0,u.io)(d.Y),N=(0,c.useState)(""),b=(0,i.Z)(N,2),y=b[0],Z=b[1],k=(0,c.useState)(!1),I=(0,i.Z)(k,2),S=I[0],C=I[1],A=(0,c.useState)(null),R=(0,i.Z)(A,2),E=R[0],H=R[1],L=(0,c.useState)(),M=(0,i.Z)(L,2),T=M[0],U=M[1],z=(0,m.CG)((function(e){return e.user})),G=(0,m.CG)((function(e){return e.notification})),P=(0,m.TL)(),O=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.trim().length<1){e.next=17;break}return C(!0),e.prev=2,e.next=5,p.AA.sendMessage({chatRoomId:s,message:y.trim(),receiverId:t.id});case 5:a=e.sent,i=a.data,v([].concat((0,r.Z)(h),[i])),Z(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),P((0,x.sc)({message:"Hata Olu\u015ftu",description:"Mesaj\u0131n\u0131z g\xf6nderilemedi",placement:"top",isNotification:!0,status:"error"}));case 14:return e.prev=14,C(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){if(null===E||void 0===E||E.scrollIntoView({behavior:"smooth"}),h&&!T){var e=new Date,t=h.filter((function(t){return new Date(t.date).getTime()>e.setHours(0,0,0)}));U(t[0])}}),[h]),(0,c.useEffect)((function(){return g.connect(),g.on(z.user.id,(function(e){console.log("data : ",e),v([].concat((0,r.Z)(h),[e]))})),function(){console.log("return e girdi"),g.off("socket-message"),g.disconnect()}}),[g]),G.isLoading?(0,w.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,w.jsx)("img",{alt:"",src:f.j8.H})}):(0,w.jsxs)("div",{className:" h-full w-full rounded-md p-4 overflow-y-auto",children:[(0,w.jsxs)("div",{className:"h-[70vh] overflow-y-auto flex flex-col",children:[h&&h.map((function(e){return T&&T.id===e.id?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("span",{className:"w-full my-1 text-primary font-bold bg-slate-200 shadow-sm bg-opacity-50 px-5 py-2 rounded-xl text-center",children:"BUG\xdcN"}),(0,w.jsx)(j,{message:e},e.id)]}):(0,w.jsx)(j,{message:e},e.id)})),(0,w.jsx)("div",{style:{float:"left",clear:"both"},ref:function(e){return H(e)}})]}),(0,w.jsxs)("div",{className:"w-full h-[6vh] flex flex-row justify-between items-center",children:[(0,w.jsx)(l.Z,{className:"!w-[calc(100%-50px)] py-4",value:y,onChange:function(e){return Z(e.target.value)}}),S?(0,w.jsx)(o.Z,{}):(0,w.jsx)("div",{onClick:O,className:"w-11 h-11 flex justify-center items-center  rounded-full cursor-pointer",children:(0,w.jsx)("img",{alt:"send",src:f.ci.lW})})]})]})},N=function(e){var t=e.follower,s=e.selectedUser,r=e.setSelectedUser,n=e.roomId,a=e.setSelectedRoomId;return(0,w.jsx)("div",{onClick:function(){r(t),a(n)},className:"w-full h-[90px] mb-5 px-4 bg-white rounded-md cursor-pointer",children:(0,w.jsxs)("div",{className:"w-full h-full flex flex-row justify-between items-center",children:[(0,w.jsxs)("div",{className:"w-full h-full flex flex-row items-center",children:[(0,w.jsx)("div",{children:(0,w.jsx)("img",{src:t.profilePicture?t.profilePicture:f.ci.EA,alt:"",className:"w-12 h-12 rounded-full object-cover shadow-md"})}),(0,w.jsxs)("div",{className:"flex flex-col ml-5",children:[(0,w.jsx)("span",{className:"text-primary text-base drop-shadow-xl font-semibold",children:t.firstName.concat(" ",t.lastName)}),(0,w.jsx)("span",{className:"text-thirdy text-sm",children:n?"mesajla\u015fmaya devam et...":"mesajla\u015fma ba\u015flat..."})]})]}),(null===s||void 0===s?void 0:s.id)===t.id&&(0,w.jsx)("div",{className:"",children:(0,w.jsx)("img",{alt:"icon",src:f.ci.z,className:"transition-all duration-700"})})]})})},b=s.p+"static/media/wp1.9b159aa9a9ce61d37bef.jpg",y=s(6419),Z=function(){var e=(0,c.useState)(),t=(0,i.Z)(e,2),s=t[0],l=t[1],u=(0,c.useState)([]),d=(0,i.Z)(u,2),f=d[0],h=d[1],v=(0,c.useState)(null),j=(0,i.Z)(v,2),Z=j[0],k=j[1],I=(0,c.useState)([]),S=(0,i.Z)(I,2),C=S[0],A=S[1],R=(0,m.CG)((function(e){return e.user})),E=(0,m.TL)();(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.AA.getRooms();case 3:t=e.sent,s=t.data,h(s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),E((0,x.sc)({message:"Hata Olu\u015ftu",description:"Sohbet Odalar\u0131n\u0131z Y\xfcklenemedi",isNotification:!0,placement:"top",status:"error"}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[E]),(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E((0,x.wt)({isLoading:!0})),e.next=4,p.AA.getMessagesByRoomId(Z);case 4:t=e.sent,r=t.data,A(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),E((0,x.sc)({message:"Hata Olu\u015ftu",description:"".concat(null===s||void 0===s?void 0:s.firstName," ile mesajlar\u0131n\u0131z y\xfcklenemedi."),isNotification:!0,placement:"top",status:"error"}));case 12:return e.prev=12,E((0,x.wt)({isLoading:!1})),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=13;break}return e.prev=1,e.next=4,p.AA.createRoom({id:s.id});case 4:t=e.sent,a=t.data,h([].concat((0,r.Z)(f),[a])),k(a.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),(0,x.sc)({message:"Beklenmeyen Hata",description:null===(i=e.t0.response)||void 0===i?void 0:i.data.message,isNotification:!0,placement:"top",status:"error"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();Z?e():t()}),[Z,s,E]);return(0,w.jsxs)("div",{className:"w-full flex flex-row flex-wrap p-3",children:[(0,w.jsxs)("div",{className:"w-full md:w-1/2 lg:w-1/3",children:[(0,w.jsx)("h3",{className:"text-primary font-bold text-lg",children:R.user.role===y.hN.u.Customer?"TAK\u0130P ETT\u0130KLER\u0130M":"TAK\u0130P\xc7\u0130LER\u0130M"}),(0,w.jsx)("div",{className:"max-h-[80vh] overflow-y-auto",children:R.followers.map((function(e){var t=function(e){if(R.user.role===y.hN.u.Customer){var t=f.find((function(t){return t.sellerId.id===e.id}));if(t)return t.id}else{var s=f.find((function(t){return t.customerId.id===e.id}));if(s)return s.id}return null}(e);return(0,w.jsx)(N,{selectedUser:s,setSelectedUser:l,follower:e,roomId:t,setSelectedRoomId:k},e.id)}))})]}),s&&(0,w.jsxs)("div",{className:"w-full p-0  md:px-4 md:w-1/2 lg:w-2/3 rounded-sm",children:[(0,w.jsxs)("div",{className:"w-full flex flex-row justify-between items-center px-2",children:[(0,w.jsx)("h3",{className:"text-xl text-primary font-bold",children:s.firstName.concat(" ",s.lastName)}),(0,w.jsx)("button",{onClick:function(){return l(void 0)},className:"text-2xl",children:"\u2715"})]}),(0,w.jsx)("div",{className:"w-full h-[80vh] rounded-sm",style:{backgroundImage:"url(".concat(b,")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:Z?(0,w.jsx)(g,{roomId:Z,receiverUser:s,messages:C,setMessages:A},Z):(0,w.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,w.jsx)(o.Z,{size:"large"})})})]})]})}}}]);
//# sourceMappingURL=366.cf62935b.chunk.js.map